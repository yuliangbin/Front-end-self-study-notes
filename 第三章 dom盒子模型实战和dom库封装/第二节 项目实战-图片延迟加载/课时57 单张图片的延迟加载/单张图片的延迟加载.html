<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta vp
		<title>余良彬的HTML5操作</title>
		<style>
			* {
				padding:0;
				margin:0;
			}
			img {
				display:block;
				border:none;
			}
			.banner {
				width:350px;
				height:200px;
				margin:1000px auto;
				border:1px green solid;
				background:url("images/4.jpg") no-repeat center center #elelel;
				//给当前区域加一个默认的占位图，告诉用户此处图片正在加载
				
			}
			.banner img {
				width:100%;
				height:100%;
				display:none;
			}
		</style>
	</head>
	<body>	
		<div class="banner">
			<!--trueImg是当前图片的自定义属性，存储的是真实图片的地址-->
			<img src="" trueImg="images/3.jpg"/>
		</div>
		<script src="tool.js"></script>
		<script>
			var banner = document.getElementsByClassName('banner')[0],imgFir = banner.getElementsByTagName('img')[0];
			window.onscroll = function () {
				if (imgFir.loaded) {
					return ;//当图片加载完成后不在判断A < B
				}
				var A = banner.offsetHeight + tools.offset(banner).top;
				var B = tools.win("clientHeight") + tools.win("scrollTop");
				if (A < B) {
					var oImg = new Image;
					oImg.src = imgFir.getAttribute('trueImg');
					oImg.onload = function () {
						imgFir.src = this.src;
						imgFir.style.display = 'block';
						oImg = null;
						console.log(1);
					}
					imgFir.loaded = true;//设置一个属性告诉浏览器当前图片已经加载完成，不管是否重新加载
				}
			}
			
		</script>
	</body>
	
	

</html>